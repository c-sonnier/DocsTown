<div style="max-width: 600px; margin: 0 auto; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #1E293B; line-height: 1.6;">
  <%# Header %>
  <div style="text-align: center; padding: 32px 0 24px; border-bottom: 3px solid #8B5CF6;">
    <h1 style="font-size: 28px; font-weight: 800; margin: 0;">DocsTown</h1>
    <p style="color: #64748B; font-size: 14px; margin: 8px 0 0;">Weekly Digest &mdash; <%= Date.current.strftime("%B %d, %Y") %></p>
  </div>

  <%# Greeting %>
  <div style="padding: 24px 0;">
    <p style="font-size: 16px; margin: 0 0 16px;">Hey <strong><%= @user.github_username %></strong>,</p>
    <p style="font-size: 15px; color: #64748B; margin: 0;">Here's what happened in Rails documentation this week:</p>
  </div>

  <%# Stats %>
  <div style="background: #F8FAFC; border: 2px solid #E2E8F0; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
    <table style="width: 100%; border-collapse: collapse;">
      <tr>
        <td style="text-align: center; padding: 8px;">
          <div style="font-size: 32px; font-weight: 800; color: #8B5CF6;"><%= @stats[:new_voting_tasks] %></div>
          <div style="font-size: 13px; color: #64748B; font-weight: 600;">New Tasks</div>
        </td>
        <td style="text-align: center; padding: 8px;">
          <div style="font-size: 32px; font-weight: 800; color: #F472B6;"><%= @stats[:submitted_prs] %></div>
          <div style="font-size: 13px; color: #64748B; font-weight: 600;">PRs Submitted</div>
        </td>
        <td style="text-align: center; padding: 8px;">
          <div style="font-size: 32px; font-weight: 800; color: #34D399;"><%= @stats[:merged_prs] %></div>
          <div style="font-size: 13px; color: #64748B; font-weight: 600;">PRs Merged</div>
        </td>
      </tr>
    </table>
  </div>

  <%# Open Voting Tasks %>
  <% if @voting_tasks.any? %>
    <div style="margin-bottom: 24px;">
      <h2 style="font-size: 18px; font-weight: 700; margin: 0 0 16px;">Open for Voting</h2>
      <% @voting_tasks.each do |task| %>
        <div style="background: #FFFFFF; border: 1px solid #E2E8F0; border-radius: 8px; padding: 16px; margin-bottom: 8px;">
          <div style="font-family: monospace; font-size: 14px; font-weight: 600; margin-bottom: 4px;">
            <%= link_to task.method_signature, task_url(task), style: "color: #8B5CF6; text-decoration: none;" %>
          </div>
          <div style="font-size: 13px; color: #64748B;"><%= task.source_file_path %> &middot; <%= task.votes.size %> votes</div>
        </div>
      <% end %>
    </div>
  <% end %>

  <%# CTA %>
  <div style="text-align: center; padding: 16px 0 32px;">
    <%= link_to "Browse All Tasks", tasks_url, style: "display: inline-block; background: #8B5CF6; color: #FFFFFF; font-size: 16px; font-weight: 700; padding: 14px 32px; border-radius: 9999px; text-decoration: none;" %>
  </div>

  <%# Footer %>
  <div style="border-top: 1px solid #E2E8F0; padding: 24px 0; text-align: center; font-size: 13px; color: #94A3B8;">
    <p style="margin: 0 0 8px;">You're receiving this because you opted in to the weekly digest.</p>
    <p style="margin: 0;">
      <%= link_to "Unsubscribe", unsubscribe_url(token: @unsubscribe_token), style: "color: #8B5CF6; text-decoration: underline;" %>
      &middot;
      <%= link_to "Manage preferences", profile_url, style: "color: #8B5CF6; text-decoration: underline;" %>
    </p>
  </div>
</div>
